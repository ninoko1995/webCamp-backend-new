<h1><%= @user.name %>'s page</h1>

<div class='row'>
  
  <div class='col-xs-3 col-sm-3 col-md-3 col-lg-3'>
    <h2>User info</h2>
    <table class='table'>
      <tr><%= image_tag profile_url(@user) %></tr> 
      <tr>
    	  <th>name</th>
    	  <th><%= @user.name %></th>
      </tr>
      <tr>
    	  <th>self introduction</th>
    	  <th><%= @user.introduction %></th>
      </tr>
    </table>
    <% if correct_user?(@user) %>
      <%= link_to 'edit profile',edit_user_path(@user) %>
    <% end  %>

    <%= link_to 'favorites',user_favorites_path(@user) %>

    <h2>New book</h2>
    <%= render 'books/form', book: @book %>

  </div>
  

  <div class='col-xs-9 col-sm-9 col-md-9 col-lg-9'>
    <h2>Favorite Books</h2>

    <table class='table'>
      <thead>
        <tr> 
          <th>Title</th>
          <th>Body</th>
          <th>User</th>
          <th colspan="3"></th>
        </tr>
      </thead>

      <tbody>
        <% @favorites.each do |favorite| %>
          <tr>
            <td><%= favorite.book.title %></td>
            <td><%= favorite.book.body %></td>
            <td><%= favorite.book.user.name %></td>

            <% if Favorite.find_by(user_id: current_user.id,book_id: favorite.book_id).nil? %>
                <td><%= link_to "#{favorite.book.favorites.count}いいね!", book_favorites_path(favorite.book),method: :post ,class: 'glyphicon glyphicon-heart-empty'%></td>
            <% else %>
                <td><%= link_to "#{favorite.book.favorites.count}いいね!", book_favorites_path(favorite.book), method: :delete,class: 'glyphicon glyphicon-heart' %></td>
            <% end %>
          
            <td><%= link_to 'Show', book_path(favorite.book) %></td>
            <% if correct_user?(favorite.book.user) %>
    	        <td><%= link_to 'Edit', edit_book_path(favorite.book) %></td>
    	        <td><%= link_to 'Destroy', book_path(favorite.book), method: :delete, data: { confirm: 'Are you sure?' } %></td>
    	      <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

</div>