<!DOCTYPE html>
<html>
  <head>
    <title>WebCampBackendNew</title>
    <%= csrf_meta_tags %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
   
    <%= render 'layouts/header' %>

  	<div class='body'>
      
      <% if !@book.blank? %>
        <%= render 'layouts/errors',book:@book %>
      <% end %>
        
      <p id="notice"><%= notice %></p>
      
      
      <div class='header-image' style="background-image:url(<%= header_url(@user)%>);">

        <div class='header-edit'>
          <%= form_for(@user) do |f| %>
            <%= f.file_field :header_image %>
            <div class="button">
              <%= f.submit :class => "btn btn-default" %>
              <span class="btn btn-danger" id='cancel-header'>cancel</span> 
            </div>
          <% end %>
        </div>

        <% if current_user.id = params[:id] %>
          <span class='glyphicon glyphicon-chevron-up' id='edit-header'></span>
        <% end %> 
      </div>

      <!-- normal -->
      <div class='menu' style='border-bottom:1px solid rgba(0,0,0,0.1);'>
        <div class='container'>
          <div class="row">
            <%= link_to "#{@user.books.count} books",user_path(@user),class: "btn btn-#{@boo} col-xs-1 col-xs-offset-3"%>

            <%= link_to "#{@user.favorites.count} favorites",user_favorites_path(@user),class: "btn  btn-#{@fav} col-xs-1" %>

            
            
            <%= link_to "#{@user.followings.count} followings",follows_user_path(@user),class: "btn btn-#{@wing} col-xs-1" %>
            <%= link_to "#{@user.followers.count} followers",followers_user_path(@user),class: "btn btn-#{@wer} col-xs-1" %>
            <% if @user.locked && @user == current_user%>
              <%= link_to "#{@user.requires.count} requires",requires_user_path(@user) , class: "btn btn-#{@ire} col-xs-1"%>
            <% else %>
              <span class='col-xs-1'></span>
            <% end %>

            
            <% if correct_user?(@user) %>
              <p class="btn btn-default col-xs-1 col-xs-offset-3 glyphicon glyphicon-cog" id= 'edit-profile' ></p>
              <span class="btn btn-danger col-xs-1 col-xs-offset-3" id='cancel-profile'>cancel</span> 
            <% else %>
              <% if @user.followed_by?(current_user) %>
                <%= link_to "following",user_relationship_path(user.id,Relationship.find_by(follower_id: current_user.id,followed_id: @user.id).id),method: :delete,class: "btn btn-primary col-xs-offset-3 col-xs-1",remote: true %>
              <% else %>
                <% if @user.requested_by?(current_user) %>
                  <%= link_to 'requesting',user_relationship_path(current_user.id,Relationship.find_by(follower_id: current_user.id,followed_id: @user.id,accepted: false).id),method: :delete,class: 'btn btn-info col-xs-1 col-xs-offset-3 disable' %>
                <% else %>
                  <%= link_to "follow",user_relationships_path(@user.id),method: :post,class: "btn btn-default col-xs-1 col-xs-offset-3",remote: true %>
                <% end %>
              <% end %>
            <% end  %>
      
          </div>
        </div>
      </div>
      <div class='main'>
        <div class='container'>
        	<%= yield %>
        </div>
      </div>
    </div>
  </body>
</html>
